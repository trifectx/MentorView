<!-- Turn video on/off -->
<div class="d-flex justify-content-center">
    <button
        class="btn btn-primary"
        (click)="getCam()"
        [ngClass]="!showCam ? 'show' : 'hide'"
    >
        Turn The Video On
    </button>

    <div
        class="interview-setup card shadow-sm"
        *ngIf="!transcript && !loadingRating"
    >
        <div class="card-header bg-primary text-white">
            <h3 class="mb-0">Interview Details</h3>
        </div>
        <div class="card-body">
            <div class="form-group mb-3">
                <label for="role" class="form-label">Role</label>
                <div class="input-group">
                    <span class="input-group-text"
                        ><i class="bi bi-person-badge"></i
                    ></span>
                    <input
                        type="text"
                        id="role"
                        [(ngModel)]="interviewDetails.role"
                        placeholder="e.g. Software Engineer"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="form-group mb-3">
                <label for="company" class="form-label">Company</label>
                <div class="input-group">
                    <span class="input-group-text"
                        ><i class="bi bi-building"></i
                    ></span>
                    <input
                        type="text"
                        id="company"
                        [(ngModel)]="interviewDetails.company"
                        placeholder="e.g. Google"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="form-group mb-3">
                <label for="interviewStyle" class="form-label"
                    >Interview Style</label
                >
                <div class="input-group">
                    <span class="input-group-text"
                        ><i class="bi bi-list-check"></i
                    ></span>
                    <select
                        id="interviewStyle"
                        [(ngModel)]="interviewDetails.style"
                        (change)="onStyleChange($event)"
                        class="form-select"
                    >
                        <option value="">Select an interview style</option>
                        <option
                            *ngFor="let style of interviewStyles"
                            [value]="style.id"
                        >
                            {{ style.name }}
                        </option>
                    </select>
                </div>
            </div>
            <div class="form-group mb-3" *ngIf="selectedQuestions.length > 0">
                <label for="question" class="form-label"
                    >Interview Question</label
                >
                <div class="input-group">
                    <span class="input-group-text"
                        ><i class="bi bi-question-circle"></i
                    ></span>
                    <select
                        id="question"
                        [(ngModel)]="interviewDetails.question"
                        class="form-select"
                    >
                        <option value="">Select a question</option>
                        <option
                            *ngFor="let question of selectedQuestions"
                            [value]="question"
                        >
                            {{ question }}
                        </option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <button
        class="btn btn-danger"
        (click)="stopCam()"
        [ngClass]="showCam ? 'show' : 'hide'"
    >
        Turn The Video Off
    </button>
</div>

<span class="m-2"></span>

<!-- Video Recording Section -->
<div [ngClass]="showCam ? 'show' : 'hide'" class="video-container">
    <video
        #video
        id="videoStream"
        autoplay
        controls
        class="video-player"
    ></video>
    <br />
    <button class="btn btn-success" (click)="start()" [disabled]="isRecording">
        Start Recording
    </button>
    <button class="btn btn-warning" (click)="stop()" [disabled]="!isRecording">
        Stop Recording
    </button>
</div>

<span class="m-2"></span>

<!-- Recorded Videos Section -->
<div [ngClass]="showVideos ? 'show' : 'hide'" class="video-container">
    <h2>Recorded Videos</h2>
    <video
        #recordedVideo
        id="videoStream"
        autoplay
        controls
        class="video-player"
    ></video>
    <br />

    <button class="btn btn-info" (click)="getTranscript()">
        Get Transcript
    </button>

    <!-- Transcript Display Section -->
    <div *ngIf="loadingTranscript || transcript">
        <h3>Transcript:</h3>
        <pre class="transcript-text">{{
            loadingTranscript
                ? "Loading transcript..."
                : transcript || "No transcript available"
        }}</pre>
    </div>

    <button
        class="btn btn-secondary"
        (click)="getRating()"
        *ngIf="!loadingTranscript && transcript"
    >
        Get Rating
    </button>

    <!-- Rating Display Section -->
    <div *ngIf="loadingRating || rating">
        <h3>Rating:</h3>
        <pre class="transcript-text">{{
            loadingRating
                ? "Loading rating..."
                : rating || "No rating available"
        }}</pre>
    </div>
</div>
